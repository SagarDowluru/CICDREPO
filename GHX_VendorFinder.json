[{"name":"GHX_VendorFinder","description":"","scriptCode":"import json\r\nfrom fuzzywuzzy import fuzz\r\nimport re\r\n\r\n# JSON response\r\njson_response = vendor_Json\r\ndata = json.loads(json_response)\r\nout_Vendor=\"NA\"\r\n\r\ndata = json.loads(json_response)\r\n\r\n\r\ndef remove_special_characters(text):\r\n    return re.sub(r'[^A-Za-z0-9\\s]', '', text)\r\n\r\n# Calculate combined similarity\r\ndef combined_similarity(a, b):\r\n    a_clean = remove_special_characters(a.lower())\r\n    b_clean = remove_special_characters(b.lower())\r\n    token_set_ratio = fuzz.token_set_ratio(a_clean, b_clean)\r\n    partial_ratio = fuzz.partial_ratio(a_clean, b_clean)\r\n    return (token_set_ratio + partial_ratio) / 2\r\n\r\n# Vendor name to search for\r\nsearch_vendor = vendor_Name\r\n\r\nbest_match = None\r\nhighest_similarity = 0\r\nsimilarity_threshold = 45\r\n\r\nfor item in data:\r\n    if \"_fields\" in item:\r\n        vendor_name = item[\"_fields\"][\"VendorName\"]\r\n        similarity = combined_similarity(search_vendor, vendor_name)\r\n        if similarity > highest_similarity:\r\n            highest_similarity = similarity\r\n            best_match = item[\"_fields\"]\r\n\r\n# print(f\"Best match: {best_match}, Similarity: {highest_similarity}\")\r\n\r\nif highest_similarity >= similarity_threshold:\r\n    out_Similarity=highest_similarity\r\n    out_Vendor=best_match\r\nelse:\r\n    out_Similarity=highest_similarity\r\n    out_Vendor=\"NA\"\r\n","documentation":"","usedLibraries":[{"name":"fuzzywuzzy","version":"0.18.0"}],"inputVariables":[],"outputVariables":[],"variables":[{"name":"out_Vendor","fileName":"","description":"","dataType":"STRING","type":"OUTPUT","content":null},{"name":"vendor_Json","fileName":"","description":"","dataType":"STRING","type":"INPUT","content":null},{"name":"out_Similarity","fileName":"","description":"","dataType":"STRING","type":"OUTPUT","content":null},{"name":"vendor_Name","fileName":"","description":"","dataType":"STRING","type":"INPUT","content":null}]}]